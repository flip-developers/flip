if("undefined"==typeof Haw)var Haw={};Haw.Facebook=function(){var e=["user_photos","email","user_birthday","user_location","user_relationship_details"],t={authorizeUrl:"https://graph.facebook.com/oauth/authorize",minPermissions:e},i=function(e){return"undefined"==typeof e?t.minPermissions:t.minPermissions.concat(e)},n=function(e,t){FB.login(function(e){"connected"===e.status?t.success():t.error()},{scope:e.join(",")})},r=function(e){var t=e.permissions,i=[];FB.api("/me/permissions",function(r){var o=r.data[0];for(var s in t)null===o[t[s]]&&i.push(t[s]);i.length>0?n(i,e):e.success()})};return{connect:function(e,t){var n=i(t);FB.getLoginStatus(function(t){"connected"===t.status?r({permissions:n,success:e.success,error:e.error}):FB.login(function(t){"connected"===t.status?e.success(t):"undefined"!=typeof e.error&&e.error(t)},{scope:n.join(",")})})},getProfileImage:function(e){FB.api("/me?fields=picture.width(9999).height(9999)",function(t){e(t.picture.data.url)})},getAlbums:function(e){this.albums=[];var t,i=this,n=function(){FB.api("/me/albums",function(n){t=$.map(n.data,function(e){return e.count>0?{id:e.id,name:e.name,count:e.count,cover_photo_id:e.cover_photo,cover_photo:""}:void 0}),$.each(t,function(n,r){FB.api("/"+r.id+"/photos",function(o){var s=$.map(o.data,function(e,t){return(e.id===r.cover_photo_id||0===t)&&(r.cover_photo=e.picture),{source:e.source,picture:e.picture}});r.photos=s,i.albums.push(r),t.length-1===n&&($.event.trigger("facebookAlbumsLoaded"),"undefined"!=typeof e&&e())})})})};Haw.Facebook.connect({success:n})},getAlbum:function(e){return $.grep(this.albums,function(t){return t.id==e})[0]},postToFeed:function(e,t){e=e||{},t=t||$.noop,e.method="feed",FB.ui(e,t)}}}();